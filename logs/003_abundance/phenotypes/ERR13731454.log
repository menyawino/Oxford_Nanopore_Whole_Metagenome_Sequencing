/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/fuzz.py:11: UserWarning: Using slow pure-python SequenceMatcher. Install python-Levenshtein to remove this warning
  warnings.warn('Using slow pure-python SequenceMatcher. Install python-Levenshtein to remove this warning')
Phenotype DataFrame columns: Index(['phenotype', 'taxonomic rank', 'NCBI taxon ID', 'scientific name',
       'nr. total valid samples of this phenotype',
       'samples in which current taxon is found', 'abudance mean',
       'abundance median', 'abundance sd', 'phenotype term',
       'phenoype description'],
      dtype='object')
Traceback (most recent call last):
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/process.py", line 108, in extractWithoutOrder
    for key, choice in choices.items():
                       ^^^^^^^^^^^^^
AttributeError: 'numpy.ndarray' object has no attribute 'items'. Did you mean: 'item'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/omar/pipelines/ont/work/scripts/calculate_phenotype_likelihood.py", line 71, in <module>
    main()
  File "/mnt/omar/pipelines/ont/work/scripts/calculate_phenotype_likelihood.py", line 67, in main
    likelihoods = calculate_likelihood(bracken_df, phenotype_df)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/omar/pipelines/ont/work/scripts/calculate_phenotype_likelihood.py", line 32, in calculate_likelihood
    matched_species = fuzzy_match_species(species, phenotype_species_list)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/omar/pipelines/ont/work/scripts/calculate_phenotype_likelihood.py", line 22, in fuzzy_match_species
    match, score = process.extractOne(species, phenotype_species_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/process.py", line 220, in extractOne
    return max(best_list, key=lambda i: i[1])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/process.py", line 117, in extractWithoutOrder
    score = scorer(processed_query, processed)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/fuzz.py", line 291, in WRatio
    ptser = partial_token_set_ratio(p1, p2, full_process=False) \
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/fuzz.py", line 173, in partial_token_set_ratio
    return _token_set(s1, s2, partial=True, force_ascii=force_ascii, full_process=full_process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/utils.py", line 38, in decorator
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/fuzz.py", line 163, in _token_set
    ratio_func(combined_1to2, combined_2to1)
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/utils.py", line 38, in decorator
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/utils.py", line 29, in decorator
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/utils.py", line 47, in decorator
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/site-packages/fuzzywuzzy/fuzz.py", line 47, in partial_ratio
    blocks = m.get_matching_blocks()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/difflib.py", line 454, in get_matching_blocks
    i, j, k = x = self.find_longest_match(alo, ahi, blo, bhi)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omar/Downloads/miniconda3/envs/ont/lib/python3.12/difflib.py", line 385, in find_longest_match
    k = newj2len[j] = j2lenget(j-1, 0) + 1
                      ^^^^^^^^^^^^^^^^
KeyboardInterrupt
